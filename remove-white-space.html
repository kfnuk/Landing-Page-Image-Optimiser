<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" type="image/png" href="favicon.png" />
  <title>Remove White Space from Image</title>
  <style>
    body {
      font-family: 'Helvetica Neue', Arial, sans-serif;
      background-color: #f7f8fa;
      margin: 0;
      padding: 0;
      color: #333;
    }
    header {
      background: #6366f1;
      padding: 15px 30px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    header h1 {
      color: #fff;
      margin: 0;
      font-size: 1.5rem;
    }
    nav a {
      color: #fff;
      margin-left: 15px;
      text-decoration: none;
      font-weight: 500;
    }
    nav a:hover {
      text-decoration: underline;
    }
    main {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 40px 20px;
    }
    #drop-zone {
      border: 2px dashed #bbb;
      border-radius: 12px;
      width: 100%;
      max-width: 500px;
      height: 200px;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      background-color: #fff;
      transition: background-color 0.3s;
      margin-bottom: 20px;
      padding: 20px;
      cursor: pointer;
    }
    #drop-zone.hover {
      background-color: #e0e7ff;
    }
    input[type="file"] {
      display: none;
    }
    #output {
      margin-top: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    canvas {
      max-width: 100%;
      border-radius: 10px;
      margin-bottom: 10px;
    }
    .download-btn {
      background-color: #22c55e;
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 8px 16px;
      font-size: 0.9rem;
      text-decoration: none;
    }
  </style>
</head>
<body>
  <header>
    <h1>Image Tools</h1>
  <nav>
    <a href="index.html">WebP Converter</a>
    <a href="remove-white-space.html">Remove White Space</a>
    <a href="crop-image.html">Crop Image</a>
  </nav>
    </nav>
  </header>
  <main>
    <h2>Remove White Space</h2>
    <div id="drop-zone">Drop PNG here or click to upload</div>
    <input type="file" id="file-input" accept="image/png">
    <div id="output"></div>
  </main>
  <script>
    const dropZone = document.getElementById('drop-zone');
    const fileInput = document.getElementById('file-input');
    const output = document.getElementById('output');

    dropZone.addEventListener('click', () => fileInput.click());
    dropZone.addEventListener('dragover', (e) => {
      e.preventDefault();
      dropZone.classList.add('hover');
    });
    dropZone.addEventListener('dragleave', () => dropZone.classList.remove('hover'));
    dropZone.addEventListener('drop', (e) => {
      e.preventDefault();
      dropZone.classList.remove('hover');
      handleFile(e.dataTransfer.files[0]);
    });
    fileInput.addEventListener('change', () => handleFile(fileInput.files[0]));

    function handleFile(file) {
      if (!file || file.type !== 'image/png') {
        alert('Please upload a PNG image.');
        return;
      }

      const reader = new FileReader();
      reader.onload = (e) => {
        const img = new Image();
        img.onload = () => cropWhiteSpace(img);
        img.src = e.target.result;
      };
      reader.readAsDataURL(file);
    }

    function cropWhiteSpace(image) {
      const canvas = document.createElement('canvas');
      const ctx = canvas.getContext('2d');
      canvas.width = image.width;
      canvas.height = image.height;
      ctx.drawImage(image, 0, 0);

      const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
      const pixels = imageData.data;

      let top = null, bottom = null, left = null, right = null;

      for (let y = 0; y < canvas.height; y++) {
        for (let x = 0; x < canvas.width; x++) {
          const idx = (y * canvas.width + x) * 4;
          const alpha = pixels[idx + 3];
          if (alpha !== 0) {
            if (top === null) top = y;
            bottom = y;
            if (left === null || x < left) left = x;
            if (right === null || x > right) right = x;
          }
        }
      }

      if (top === null) {
        alert("The image appears to be completely transparent.");
        return;
      }

      const trimmedWidth = right - left + 1;
      const trimmedHeight = bottom - top + 1;
      const trimmedCanvas = document.createElement('canvas');
      trimmedCanvas.width = trimmedWidth;
      trimmedCanvas.height = trimmedHeight;
      trimmedCanvas.getContext('2d').drawImage(canvas, left, top, trimmedWidth, trimmedHeight, 0, 0, trimmedWidth, trimmedHeight);

      output.innerHTML = '';
      output.appendChild(trimmedCanvas);

      trimmedCanvas.toBlob(blob => {
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = 'trimmed-image.png';
        link.className = 'download-btn';
        link.textContent = 'Download Trimmed Image';
        output.appendChild(link);
      });
    }
  </script>
</body>
</html>
